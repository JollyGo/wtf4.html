<!--by Kevin ZHANG-->
<!--17197602@qq.com-->
{% extends "bootstrap/base.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% import "_wtf4v.html" as _wtf4v %}


{% block title %}wtf.html with validator for Bootstrap 4{% endblock %}

{% block head %}
    {{ super() }}
    <meta charset="utf-8">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css">
{% endblock %}

{% block content %}
    <div id="app" class="row comment-form" style="margin-top: 80px">
        <div class="col-lg-6 offset-lg-3">
            <h3 class="panel-title">
                <a href="#" ><i class="fa fa-pencil">&nbsp</i>wtf.quick_form with Validator </a></h3>
            {{ _wtf4v.quick_form(form, form_type="basic", button_map={'submit':'primary', }, id='form',
            fa_map={'email': 'fa-envelope-o','name': 'fa-user-o',},
            validator_map={
                'comment': {
                    'validators': '{minlength:3, maxlength:10}',
                    'feedbacks': {'minlength':'your comments need more than 3 chars', 'maxlength':'your comments should not exceed 10 chars'}
                    },
                'name':  {
                    'validators': '{required: true}',
                    'feedbacks': {'required':'name is required'}
                    },
                'email':  {
                    'validators': '{required: true}',
                    'feedbacks': {'required':'email is required'}
                    },
                'submit': {
                   	'@click': 'submitMethod',
                    'v-bind:class': "[{'disabled': $validation.invalid && $validation.touched}]"
                    }
                }
            ) }}
        </div>
    </div>


{% endblock %}

{% block scripts %}
    {{ super() }}
    <script src="http://cdn.jsdelivr.net/vue/1.0.28/vue.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="//cdn.bootcss.com/vue-validator/2.1.3/vue-validator.min.js" type="text/javascript" charset="utf-8"></script>
    {#    <script src="https://unpkg.com/vue-validator@3.0.0-alpha.1/dist/vue-validator.min.js"></script>#}
    <script>
        function stopDefault( e ) {
            if ( e && e.preventDefault )
                e.preventDefault();
            else
                window.event.returnValue = false;
            return false;
        }

        new Vue({
            el: '#app',
            methods:{
                submitMethod:function (e) {
                    var self = this;
                    /**
                     * 验证目标表单元素。
                     * true:验证所有
                     */
                    self.$validate(true,function () {
                        /*如果所有条件都是false*/
                        if(!self.$validation.invalid){
                            alert("Validate pass! Now submit...");
                            document.getElementById("form").submit()
                        }
                        //                   else { alert("pls fill fields"); }
                    });
                    stopDefault(e); 	// if not validated, stop submit action
                }
            }
        });


    </script>

{% endblock %}
